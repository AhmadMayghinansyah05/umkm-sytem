<!-- ============================================
FILE: templates/rekomendasi.html (UPDATED & IMPROVED)
Halaman Rekomendasi Produk yang Lengkap
============================================ -->

{% extends "base.html" %}
{% block title %}Rekomendasi Produk - Sistem UMKM{% endblock %}
{% block content %}
<div class="flex min-h-screen bg-gray-50">
    <!-- Sidebar -->
    <div class="fixed left-0 top-0 h-full w-64 bg-white border-r p-6">
        <div class="flex items-center gap-3 mb-8">
            <div class="p-2 bg-blue-600 rounded-lg">
                <i class="fas fa-shopping-bag text-white"></i>
            </div>
            <div>
                <h2 class="font-bold text-gray-800">Sistem UMKM</h2>
                <p class="text-xs text-gray-500">Dashboard</p>
            </div>
        </div>
        
        <nav class="space-y-1">
            <a href="/dashboard" class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50">
                <i class="fas fa-home"></i><span>Dashboard</span>
            </a>
            <a href="/input-penjualan" class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50">
                <i class="fas fa-dollar-sign"></i><span>Input Penjualan</span>
            </a>
            <a href="/prediksi" class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50">
                <i class="fas fa-chart-line"></i><span>Prediksi</span>
            </a>
            <a href="/rekomendasi" class="flex items-center gap-3 px-4 py-3 rounded-lg bg-blue-50 text-blue-600 font-semibold">
                <i class="fas fa-box"></i><span>Rekomendasi</span>
            </a>
            <a href="/aktivitas-log" class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50">
                <i class="fas fa-history"></i><span>Log Aktivitas</span>
            </a>
        </nav>
        
        <div class="absolute bottom-6 left-6 right-6">
            <div class="bg-gray-50 rounded-lg p-4 mb-3">
                <p class="text-xs text-gray-500">Akun</p>
                <p class="text-sm font-semibold">{{user_name if user_name else 'Toko Berkah Jaya'}}</p>
            </div>
            <a href="/logout" class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-red-50 hover:text-red-600">
                <i class="fas fa-sign-out-alt"></i><span>Keluar</span>
            </a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="ml-64 flex-1 p-8">
        <!-- Header -->
        <div class="mb-6">
            <h1 class="text-2xl font-bold text-gray-800 mb-2">Rekomendasi Produk AI</h1>
            <p class="text-gray-600">Sistem hybrid recommendation menganalisis profil bisnis Anda untuk memberikan saran produk terbaik</p>
        </div>

        <!-- Filter & Controls -->
        <div class="bg-white rounded-xl shadow-sm border p-6 mb-6">
            <div class="flex items-center justify-between">
                <div class="flex gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Metode Rekomendasi</label>
                        <select class="px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="hybrid">Hybrid (Demographic + Content)</option>
                            <option value="demographic">Demographic Filtering</option>
                            <option value="content">Content-Based Filtering</option>
                            <option value="collaborative">Collaborative Filtering</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Kategori</label>
                        <select class="px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="all">Semua Kategori</option>
                            <option value="makanan">Makanan & Minuman</option>
                            <option value="fashion">Fashion</option>
                            <option value="handicraft">Handicraft</option>
                            <option value="elektronik">Elektronik</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Minimum Match</label>
                        <select class="px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="70">≥ 70%</option>
                            <option value="80">≥ 80%</option>
                            <option value="90">≥ 90%</option>
                        </select>
                    </div>
                </div>
                <button class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2">
                    <i class="fas fa-sync-alt"></i> Refresh Rekomendasi
                </button>
            </div>
        </div>

        <!-- Stats Overview -->
        <div class="grid grid-cols-4 gap-6 mb-6">
            <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white">
                <div class="flex items-center justify-between mb-2">
                    <p class="text-blue-100 text-sm">Total Rekomendasi</p>
                    <i class="fas fa-boxes text-2xl text-blue-200"></i>
                </div>
                <p class="text-3xl font-bold mb-1">{{products|length}}</p>
                <p class="text-sm text-blue-100">Produk tersedia</p>
            </div>

            <div class="bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl shadow-lg p-6 text-white">
                <div class="flex items-center justify-between mb-2">
                    <p class="text-emerald-100 text-sm">High Match</p>
                    <i class="fas fa-star text-2xl text-emerald-200"></i>
                </div>
                <p class="text-3xl font-bold mb-1">3</p>
                <p class="text-sm text-emerald-100">Match ≥ 90%</p>
            </div>

            <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg p-6 text-white">
                <div class="flex items-center justify-between mb-2">
                    <p class="text-purple-100 text-sm">Rata-rata Match</p>
                    <i class="fas fa-percentage text-2xl text-purple-200"></i>
                </div>
                <p class="text-3xl font-bold mb-1">82.5%</p>
                <p class="text-sm text-purple-100">Compatibility</p>
            </div>

            <div class="bg-gradient-to-br from-amber-500 to-amber-600 rounded-xl shadow-lg p-6 text-white">
                <div class="flex items-center justify-between mb-2">
                    <p class="text-amber-100 text-sm">Potensi Profit</p>
                    <i class="fas fa-chart-line text-2xl text-amber-200"></i>
                </div>
                <p class="text-3xl font-bold mb-1">+25%</p>
                <p class="text-sm text-amber-100">Est. peningkatan</p>
            </div>
        </div>

        <!-- Tabs -->
        <div class="bg-white rounded-xl shadow-sm border mb-6">
            <div class="flex border-b">
                <button class="px-6 py-4 font-semibold text-blue-600 border-b-2 border-blue-600">
                    <i class="fas fa-fire mr-2"></i>Top Rekomendasi
                </button>
                <button class="px-6 py-4 font-semibold text-gray-600 hover:text-gray-800">
                    <i class="fas fa-users mr-2"></i>Berdasarkan UMKM Serupa
                </button>
                <button class="px-6 py-4 font-semibold text-gray-600 hover:text-gray-800">
                    <i class="fas fa-chart-bar mr-2"></i>Trending
                </button>
                <button class="px-6 py-4 font-semibold text-gray-600 hover:text-gray-800">
                    <i class="fas fa-bookmark mr-2"></i>Tersimpan
                </button>
            </div>
        </div>

        <!-- Top Recommendations Grid -->
        <div class="grid grid-cols-3 gap-6 mb-6">
            {% for product in products %}
            <div class="bg-white rounded-xl shadow-sm border overflow-hidden hover:shadow-xl transition-all group">
                <!-- Product Image with Match Badge -->
                <div class="relative h-56 bg-gradient-to-br from-indigo-100 via-purple-100 to-pink-100 overflow-hidden">
                    <div class="absolute inset-0 flex items-center justify-center">
                        <i class="fas fa-box-open text-7xl text-indigo-200 group-hover:scale-110 transition-transform"></i>
                    </div>
                    
                    <!-- Match Score Badge -->
                    <div class="absolute top-4 right-4">
                        {% if product.match >= 90 %}
                        <div class="px-4 py-2 bg-emerald-500 text-white rounded-full font-bold text-sm shadow-lg">
                            <i class="fas fa-star"></i> {{product.match}}%
                        </div>
                        {% elif product.match >= 80 %}
                        <div class="px-4 py-2 bg-blue-500 text-white rounded-full font-bold text-sm shadow-lg">
                            <i class="fas fa-thumbs-up"></i> {{product.match}}%
                        </div>
                        {% else %}
                        <div class="px-4 py-2 bg-purple-500 text-white rounded-full font-bold text-sm shadow-lg">
                            {{product.match}}%
                        </div>
                        {% endif %}
                    </div>

                    <!-- Category Badge -->
                    <div class="absolute top-4 left-4">
                        <span class="px-3 py-1 bg-white/90 backdrop-blur-sm text-gray-700 text-xs font-semibold rounded-full">
                            {{product.category}}
                        </span>
                    </div>
                </div>

                <!-- Product Info -->
                <div class="p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">{{product.name}}</h3>
                    <p class="text-sm text-gray-600 mb-4 line-clamp-2">Produk berkualitas tinggi dengan potensi penjualan yang baik di segmen pasar Anda</p>

                    <!-- Match Details -->
                    <div class="space-y-3 mb-4">
                        <div>
                            <div class="flex items-center justify-between text-xs mb-1">
                                <span class="text-gray-600">Demographic Match</span>
                                <span class="font-semibold text-gray-800">{{product.match - 5}}%</span>
                            </div>
                            <div class="w-full bg-gray-100 rounded-full h-2">
                                <div class="bg-blue-500 h-2 rounded-full" style="width: {{product.match - 5}}%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex items-center justify-between text-xs mb-1">
                                <span class="text-gray-600">Content Match</span>
                                <span class="font-semibold text-gray-800">{{product.match}}%</span>
                            </div>
                            <div class="w-full bg-gray-100 rounded-full h-2">
                                <div class="bg-purple-500 h-2 rounded-full" style="width: {{product.match}}%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Tags -->
                    <div class="flex flex-wrap gap-2 mb-4">
                        <span class="px-2 py-1 bg-blue-50 text-blue-700 text-xs font-medium rounded">
                            <i class="fas fa-fire text-orange-500"></i> Hot Seller
                        </span>
                        <span class="px-2 py-1 bg-emerald-50 text-emerald-700 text-xs font-medium rounded">
                            <i class="fas fa-arrow-trend-up"></i> Trending
                        </span>
                    </div>

                    <!-- Alasan Rekomendasi -->
                    <div class="bg-gray-50 rounded-lg p-3 mb-4">
                        <p class="text-xs font-semibold text-gray-700 mb-2">
                            <i class="fas fa-lightbulb text-amber-500"></i> Kenapa Direkomendasikan?
                        </p>
                        <ul class="text-xs text-gray-600 space-y-1">
                            <li class="flex items-start gap-2">
                                <i class="fas fa-check text-emerald-600 mt-0.5"></i>
                                <span>Cocok dengan profil bisnis Anda</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fas fa-check text-emerald-600 mt-0.5"></i>
                                <span>Potensi margin keuntungan tinggi</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fas fa-check text-emerald-600 mt-0.5"></i>
                                <span>UMKM serupa mencatat penjualan bagus</span>
                            </li>
                        </ul>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex gap-2">
                        <a href="/detail-produk/{{loop.index}}" class="flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold text-sm text-center">
                            <i class="fas fa-info-circle mr-2"></i>Detail
                        </a>
                        <button class="px-4 py-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition">
                            <i class="fas fa-bookmark text-gray-600"></i>
                        </button>
                        <button class="px-4 py-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition">
                            <i class="fas fa-share-alt text-gray-600"></i>
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Recommendation Method Explanation -->
        <div class="grid grid-cols-3 gap-6 mb-6">
            <div class="bg-white rounded-xl shadow-sm border p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="p-3 bg-blue-50 rounded-lg">
                        <i class="fas fa-users text-blue-600 text-xl"></i>
                    </div>
                    <h3 class="font-bold text-gray-800">Demographic Filtering</h3>
                </div>
                <p class="text-sm text-gray-600 mb-4">Menganalisis profil bisnis Anda (lokasi, kategori, target market) untuk mencari produk yang cocok dengan karakteristik UMKM Anda.</p>
                <div class="flex items-center gap-2 text-sm">
                    <div class="flex-1 bg-gray-100 rounded-full h-2">
                        <div class="bg-blue-500 h-2 rounded-full" style="width: 85%"></div>
                    </div>
                    <span class="font-semibold text-gray-700">85%</span>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-sm border p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="p-3 bg-purple-50 rounded-lg">
                        <i class="fas fa-tags text-purple-600 text-xl"></i>
                    </div>
                    <h3 class="font-bold text-gray-800">Content-Based Filtering</h3>
                </div>
                <p class="text-sm text-gray-600 mb-4">Membandingkan karakteristik produk yang Anda jual dengan produk lain untuk menemukan item yang serupa dan relevan.</p>
                <div class="flex items-center gap-2 text-sm">
                    <div class="flex-1 bg-gray-100 rounded-full h-2">
                        <div class="bg-purple-500 h-2 rounded-full" style="width: 90%"></div>
                    </div>
                    <span class="font-semibold text-gray-700">90%</span>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-sm border p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="p-3 bg-emerald-50 rounded-lg">
                        <i class="fas fa-layer-group text-emerald-600 text-xl"></i>
                    </div>
                    <h3 class="font-bold text-gray-800">Hybrid Recommendation</h3>
                </div>
                <p class="text-sm text-gray-600 mb-4">Menggabungkan kedua metode untuk hasil yang lebih akurat dan personal, memberikan rekomendasi terbaik untuk bisnis Anda.</p>
                <div class="flex items-center gap-2 text-sm">
                    <div class="flex-1 bg-gray-100 rounded-full h-2">
                        <div class="bg-emerald-500 h-2 rounded-full" style="width: 92%"></div>
                    </div>
                    <span class="font-semibold text-gray-700">92%</span>
                </div>
            </div>
        </div>

        <!-- Success Stories -->
        <div class="bg-white rounded-xl shadow-sm border p-6 mb-6">
            <h2 class="text-lg font-bold text-gray-800 mb-6">
                <i class="fas fa-trophy text-amber-500 mr-2"></i>
                UMKM yang Sukses dengan Rekomendasi Ini
            </h2>
            <div class="grid grid-cols-3 gap-6">
                <div class="p-4 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border border-blue-100">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold">
                            WS
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800">Warung Sari Rasa</p>
                            <p class="text-xs text-gray-500">Kuliner • Jakarta</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">Menambah produk rekomendasi dan meningkatkan revenue hingga 35% dalam 3 bulan</p>
                    <div class="flex items-center gap-2 text-sm text-emerald-600 font-semibold">
                        <i class="fas fa-arrow-up"></i>
                        <span>+35% Revenue</span>
                    </div>
                </div>

                <div class="p-4 bg-gradient-to-br from-emerald-50 to-green-50 rounded-lg border border-emerald-100">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="w-12 h-12 bg-emerald-600 rounded-full flex items-center justify-center text-white font-bold">
                            BN
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800">Batik Nusantara</p>
                            <p class="text-xs text-gray-500">Fashion • Yogyakarta</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">Ekspansi produk berdasarkan rekomendasi, customer base bertambah 50+</p>
                    <div class="flex items-center gap-2 text-sm text-emerald-600 font-semibold">
                        <i class="fas fa-users"></i>
                        <span>+50 Customers</span>
                    </div>
                </div>

                <div class="p-4 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg border border-purple-100">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="w-12 h-12 bg-purple-600 rounded-full flex items-center justify-center text-white font-bold">
                            KT
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800">Kerajinan Tangan</p>
                            <p class="text-xs text-gray-500">Handicraft • Bali</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">Portfolio produk lebih beragam, penjualan online meningkat signifikan</p>
                    <div class="flex items-center gap-2 text-sm text-emerald-600 font-semibold">
                        <i class="fas fa-chart-line"></i>
                        <span>+42% Sales</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Info Alert -->
        <div class="bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6">
            <div class="flex items-start gap-4">
                <i class="fas fa-info-circle text-blue-600 text-2xl"></i>
                <div>
                    <h3 class="font-semibold text-gray-800 mb-2">Tentang Sistem Rekomendasi</h3>
                    <p class="text-sm text-gray-600 mb-3">
                        Sistem rekomendasi kami menggunakan algoritma hybrid yang menggabungkan demographic filtering dan content-based filtering. 
                        Algoritma ini dilatih dengan data dari ribuan UMKM untuk memberikan rekomendasi yang paling relevan.
                    </p>
                    <div class="grid grid-cols-3 gap-4 text-sm">
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-blue-600 mt-1"></i>
                            <span class="text-gray-600">Akurasi rekomendasi: 92%</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-blue-600 mt-1"></i>
                            <span class="text-gray-600">Data dari 500+ UMKM</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <i class="fas fa-check text-blue-600 mt-1"></i>
                            <span class="text-gray-600">Update real-time</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}